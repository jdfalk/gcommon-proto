// file: proto/gcommon/v2/common/o_auth_client.proto
// version: 1.0.0
// guid: 436333b4-e6f3-4a6d-ad0c-a4b0cb8975f8
edition = "2023";

package common.v2;

import "common/v2/resource_status.proto";
import "google/protobuf/go_features.proto";
import "google/protobuf/timestamp.proto";
import "buf/validate/validate.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/common/v2";

/**
 * OAuth2 client configuration for third-party integrations.
 * Used for OAuth2 authorization code and implicit flows.
 * Contains client credentials and configuration.
 */
message OAuthClient {
  // Unique client identifier
  string client_id = 1;

  // Client secret (for confidential clients)
  string client_secret = 2;

  // Client name
  string name = 3 [
      (buf.validate.field).string.min_len = 1,
      (buf.validate.field).string.max_len = 100
    ];

  // Client description
  string description = 4 [ (buf.validate.field).string.max_len = 1000 ];

  // Client type ("public" or "confidential")
  string client_type = 5;

  // Allowed redirect URIs
  repeated string redirect_uris = 6;

  // Allowed grant types
  repeated string grant_types = 7;

  // Allowed response types
  repeated string response_types = 8;

  // Allowed scopes
  repeated string scopes = 9;

  // Client creation timestamp
  google.protobuf.Timestamp created_at = 10 [lazy = true, (buf.validate.field).required = true];

  // Client status
  common.v2.ResourceStatus status = 11;

  // Client metadata
  map<string, string> metadata = 12 [lazy = true];

  // Client logo URL
  string logo_url = 13 [ (buf.validate.field).string.uri = true ];

  // Client website URL
  string website_url = 14 [ (buf.validate.field).string.uri = true ];

  // Client owner user ID
  string owner_user_id = 15;
}
