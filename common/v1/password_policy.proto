// file: proto/gcommon/v1/common/password_policy.proto
// version: 1.0.0
// guid: d19b7fa7-bd0d-4d6c-bc5b-2453bd250890

edition = "2023";

package common.v1;

import "google/protobuf/go_features.proto";
import "buf/validate/validate.proto";


option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/common/";

/**
 * Requirements and restrictions for user passwords.
 */
message PasswordPolicy {
  // Minimum required length for passwords.
  int32 min_length = 1 [(buf.validate.field).int32.gte = 0];

  // Require at least one uppercase letter.
  bool require_uppercase = 2;

  // Require at least one lowercase letter.
  bool require_lowercase = 3;

  // Require at least one numeric digit.
  bool require_number = 4;

  // Require at least one symbol character.
  bool require_symbol = 5;

  // Maximum password age in days before expiration.
  int32 max_age_days = 6 [(buf.validate.field).int32.gte = 0, (buf.validate.field).int32.lte = 150];

  // Number of previous passwords disallowed for reuse.
  int32 history = 7 [(buf.validate.field).int32.gte = 0];

  // Whether password reuse is permitted after history is exhausted.
  bool allow_reuse = 8;
}
