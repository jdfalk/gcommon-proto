// file: authpb/v2/change_password_request.proto
// version: 1.0.0
// guid: y6z7a8b9-c0d1-2345-6789-012345zabcde

edition = "2023";

package auth.v2;

import "google/protobuf/go_features.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/pkg/authpb";

// ChangePasswordRequest represents a request to change user password
message ChangePasswordRequest {
  // Current password (required for verification)
  string current_password = 1;

  // New password
  string new_password = 2;

  // Confirm new password
  string confirm_password = 3;

  // Whether to invalidate all existing sessions after password change
  bool invalidate_sessions = 4;

  // Whether to invalidate all existing API keys after password change
  bool invalidate_api_keys = 5;

  // Optional: Force password change (admin-only operation)
  bool force_change = 6;

  // Admin user ID for admin operations (optional - if not provided, change for current user)
  string user_id = 7;
}
