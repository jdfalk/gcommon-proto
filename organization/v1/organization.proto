// file: proto/gcommon/v1/organization/organization.proto
// version: 1.1.0
// guid: 67890def-1234-5678-9abc-def012345678

edition = "2023";

package organization.v1;

import "buf/validate/validate.proto";
import "common/v1/key_value.proto";
import "common/v1/organization_status.proto";
import "google/protobuf/go_features.proto";
import "google/protobuf/timestamp.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/pkg/organizationpb";

/**
 * Organization message representing a complete organizational entity.
 * Contains all core information needed for organization management,
 * including metadata, settings, and administrative information.
 */
message Organization {
  // Unique organization identifier (immutable) - must be valid UUID
  string id = 1 [(buf.validate.field).string.pattern = "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"];

  // Organization name (human-readable identifier) - required, 1-100 characters
  string name = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 1,
    (buf.validate.field).string.max_len = 100
  ];

  // URL-friendly slug for the organization (e.g., for subdomains) - required, alphanumeric with hyphens
  string slug = 3 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.pattern = "^[a-z0-9]([a-z0-9-]*[a-z0-9])?$",
    (buf.validate.field).string.min_len = 2,
    (buf.validate.field).string.max_len = 50
  ];

  // Organization description or mission statement - max 1000 characters
  string description = 4 [(buf.validate.field).string.max_len = 1000];

  // Primary website URL for the organization - must be valid URL if provided
  string website = 5 [(buf.validate.field).string.uri = true];

  // Primary contact email for the organization - must be valid email if provided
  string contact_email = 6 [(buf.validate.field).string.email = true];

  // Organization's physical address or headquarters location - max 500 characters
  string address = 7 [(buf.validate.field).string.max_len = 500];

  // Phone number for organization contact - basic phone format validation
  string phone = 8 [(buf.validate.field).string.pattern = "^[\\+]?[1-9]?[0-9]{7,15}$"];

  // Tax identifier or business registration number - alphanumeric only, max 50 characters
  string tax_id = 9 [
    (buf.validate.field).string.pattern = "^[a-zA-Z0-9]*$",
    (buf.validate.field).string.max_len = 50
  ];

  // Organization's industry or business sector - max 100 characters
  string industry = 10 [(buf.validate.field).string.max_len = 100];

  // Current operational status of the organization - required
  common.v1.OrganizationStatus status = 11 [(buf.validate.field).required = true];

  // Organization metadata and custom attributes - max 50 entries
  repeated common.v1.KeyValue metadata = 12 [
    lazy = true,
    (buf.validate.field).repeated.max_items = 50
  ];

  // Organization creation timestamp (immutable) - required
  google.protobuf.Timestamp created_at = 13 [
    lazy = true,
    (buf.validate.field).required = true
  ];

  // Last update timestamp - required
  google.protobuf.Timestamp updated_at = 14 [
    lazy = true,
    (buf.validate.field).required = true
  ];

  // User ID who created this organization - must be valid UUID
  string created_by = 15 [(buf.validate.field).string.pattern = "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"];

  // User ID who last updated this organization - must be valid UUID
  string updated_by = 16 [(buf.validate.field).string.pattern = "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"];

  // Organization's timezone (IANA timezone identifier) - must be valid timezone format
  string timezone = 17 [(buf.validate.field).string.pattern = "^[A-Za-z]+\\/[A-Za-z_]+([A-Za-z_\\/]*)$"];

  // Organization's primary language/locale - must be valid locale format (e.g., en-US, fr-FR)
  string locale = 18 [(buf.validate.field).string.pattern = "^[a-z]{2}(-[A-Z]{2})?$"];

  // Maximum number of members allowed in this organization - must be positive
  int32 max_members = 19 [
    (buf.validate.field).int32.gte = 1,
    (buf.validate.field).int32.lte = 100000
  ];

  // Whether this organization supports multi-tenancy
  bool multi_tenant_enabled = 20;

  // Organization's logo or avatar URL - must be valid URL if provided
  string avatar_url = 21 [(buf.validate.field).string.uri = true];

  // Organization's billing contact email (if different from contact_email) - must be valid email if provided
  string billing_email = 22 [(buf.validate.field).string.email = true];
}
