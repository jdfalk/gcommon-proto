// file: pkg/queue/proto/authentication_config.proto
// version: 1.0.0
// guid: b5c6d7e8-f9a0-1b2c-3d4e-5f6a7b8c9d0e

edition = "2023";

package gcommon.v1.queue;

option go_package = "github.com/jdfalk/gcommon/pkg/queue/proto";

/**
 * Authentication configuration for queue connections.
 * Supports multiple authentication mechanisms.
 */
message AuthenticationConfig {
  // Authentication type
  oneof auth_type {
    // No authentication required
    bool none = 1;

    // Username/password authentication
    UsernamePasswordAuth username_password = 2;

    // API key authentication
    APIKeyAuth api_key = 3;

    // TLS certificate authentication
    TLSAuth tls = 4;

    // SASL authentication
    SASLAuth sasl = 5;

    // OAuth2 authentication
    OAuth2Auth oauth2 = 6;
  }
}

/**
 * Username and password authentication.
 */
message UsernamePasswordAuth {
  // Username for authentication
  string username = 1;

  // Password for authentication (should be encrypted)
  string password = 2;
}

/**
 * API key based authentication.
 */
message APIKeyAuth {
  // API key for authentication
  string api_key = 1;

  // Optional API key ID
  string key_id = 2;
}

/**
 * TLS certificate authentication.
 */
message TLSAuth {
  // Client certificate (PEM format)
  string cert_pem = 1;

  // Client private key (PEM format)
  string key_pem = 2;

  // CA certificate (PEM format)
  string ca_pem = 3;

  // Whether to verify server certificate
  bool verify_server = 4;
}

/**
 * SASL authentication configuration.
 */
message SASLAuth {
  // SASL mechanism (PLAIN, SCRAM-SHA-256, etc.)
  string mechanism = 1;

  // Username
  string username = 2;

  // Password
  string password = 3;

  // Additional SASL properties
  map<string, string> properties = 4;
}

/**
 * OAuth2 authentication configuration.
 */
message OAuth2Auth {
  // OAuth2 token endpoint
  string token_endpoint = 1;

  // Client ID
  string client_id = 2;

  // Client secret
  string client_secret = 3;

  // Scopes to request
  repeated string scopes = 4;

  // Additional OAuth2 parameters
  map<string, string> parameters = 5;
}
