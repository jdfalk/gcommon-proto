// file: pkg/queue/proto/restore_queue_response.proto
// version: 1.1.0
// Response to queue restoration operation

edition = "2023";

package gcommon.v1.queue;

import "google/protobuf/timestamp.proto";
import "google/protobuf/duration.proto";
option go_package = "github.com/jdfalk/gcommon/pkg/queue/proto";



// RestoreQueueResponse returns the result of a queue restoration operation
message RestoreQueueResponse {
  // Operation success status
  bool success = 1;

  // Restore operation ID for tracking
  string operation_id = 2;

  // Restored queue identifier
  string restored_queue_id = 3;

  // Restoration start timestamp
  google.protobuf.Timestamp start_time = 4;

  // Restoration completion timestamp
  google.protobuf.Timestamp completion_time = 5;

  // Total restoration duration
  google.protobuf.Duration duration = 6;

  // Restoration statistics
  RestoreStatistics statistics = 7;

  // Restoration status details
  RestoreStatus status = 8;

  // Any errors encountered during restore
  repeated RestoreError errors = 9;

  // Warnings generated during restore
  repeated RestoreWarning warnings = 10;

  // Partition restoration results
  repeated PartitionRestoreResult partition_results = 11;

  // Validation results if validation was requested
  ValidationResult validation_result = 12;

  // Operation metadata
  map<string, string> metadata = 13;
}

// Statistics about the restoration operation
message RestoreStatistics {
  // Total messages restored
  int64 messages_restored = 1;

  // Total bytes restored
  int64 bytes_restored = 2;

  // Number of partitions restored
  int32 partitions_restored = 3;

  // Messages skipped due to filters
  int64 messages_skipped = 4;

  // Messages failed to restore
  int64 messages_failed = 5;

  // Average restore rate (messages/second)
  double restore_rate = 6;

  // Throughput (bytes/second)
  double throughput_bps = 7;

  // Backup file size processed
  int64 backup_size_bytes = 8;

  // Compression ratio achieved
  double compression_ratio = 9;
}

// Current status of the restoration operation
message RestoreStatus {
  // Status code (pending, in_progress, completed, failed, cancelled)
  string status_code = 1;

  // Human-readable status message
  string status_message = 2;

  // Progress percentage (0-100)
  int32 progress_percentage = 3;

  // Current operation phase
  string current_phase = 4;

  // Estimated time remaining
  google.protobuf.Duration estimated_remaining = 5;

  // Last status update timestamp
  google.protobuf.Timestamp last_update = 6;
}

// Error information from restoration
message RestoreError {
  // Error code for programmatic handling
  string error_code = 1;

  // Human-readable error message
  string error_message = 2;

  // Error category (validation, io, corruption, etc.)
  string error_category = 3;

  // Specific component that failed
  string failed_component = 4;

  // Partition ID if error is partition-specific
  int32 partition_id = 5;

  // Message offset range affected by error
  OffsetRange affected_range = 6;

  // Error timestamp
  google.protobuf.Timestamp error_time = 7;

  // Whether error is recoverable
  bool recoverable = 8;
}

// Warning information from restoration
message RestoreWarning {
  // Warning code
  string warning_code = 1;

  // Warning message
  string warning_message = 2;

  // Warning category
  string warning_category = 3;

  // Affected component
  string affected_component = 4;

  // Partition ID if warning is partition-specific
  int32 partition_id = 5;

  // Warning timestamp
  google.protobuf.Timestamp warning_time = 6;
}

// Result of restoring a specific partition
message PartitionRestoreResult {
  // Partition ID
  int32 partition_id = 1;

  // Success status for this partition
  bool success = 2;

  // Messages restored in this partition
  int64 messages_restored = 3;

  // Bytes restored in this partition
  int64 bytes_restored = 4;

  // Start offset restored
  int64 start_offset = 5;

  // End offset restored
  int64 end_offset = 6;

  // Partition restore duration
  google.protobuf.Duration restore_duration = 7;

  // Any partition-specific errors
  repeated RestoreError partition_errors = 8;

  // Partition metadata
  map<string, string> partition_metadata = 9;
}

// Backup validation results
message ValidationResult {
  // Validation success status
  bool validation_passed = 1;

  // Checksum verification results
  ChecksumValidation checksum_validation = 2;

  // Schema validation results
  SchemaValidation schema_validation = 3;

  // Data integrity validation
  IntegrityValidation integrity_validation = 4;

  // Validation errors found
  repeated ValidationError validation_errors = 5;

  // Validation duration
  google.protobuf.Duration validation_duration = 6;
}

// Checksum validation details
message ChecksumValidation {
  // Overall checksum validation passed
  bool passed = 1;

  // Expected checksum
  string expected_checksum = 2;

  // Actual checksum
  string actual_checksum = 3;

  // Checksum algorithm used
  string checksum_algorithm = 4;
}

// Schema validation details
message SchemaValidation {
  // Schema validation passed
  bool passed = 1;

  // Schema version in backup
  string backup_schema_version = 2;

  // Current schema version
  string current_schema_version = 3;

  // Schema compatibility status
  string compatibility_status = 4;
}

// Data integrity validation details
message IntegrityValidation {
  // Integrity validation passed
  bool passed = 1;

  // Corrupted message count
  int64 corrupted_messages = 2;

  // Missing message count
  int64 missing_messages = 3;

  // Duplicate message count
  int64 duplicate_messages = 4;
}

// Validation error details
message ValidationError {
  // Error type
  string error_type = 1;

  // Error description
  string description = 2;

  // Affected partition
  int32 partition_id = 3;

  // Affected offset range
  OffsetRange affected_range = 4;
}

// Offset range specification
message OffsetRange {
  // Start offset
  int64 start_offset = 1;

  // End offset
  int64 end_offset = 2;
}
