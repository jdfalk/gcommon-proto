// file: pkg/queue/proto/update_message_response.proto
// version: 1.1.0
// Response to message update operations

edition = "2023";

package gcommon.v1.queue;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/jdfalk/gcommon/pkg/queue/proto";

// UpdateMessageResponse returns the result of updating a message
message UpdateMessageResponse {
  // Success status of the update operation
  bool success = 1;

  // Updated message identifier
  string message_id = 2;

  // New message version/etag after update
  string new_version = 3;

  // Timestamp when update was applied
  google.protobuf.Timestamp updated_at = 4;

  // Fields that were successfully updated
  repeated string updated_fields = 5;

  // Fields that failed to update
  repeated FailedFieldUpdate failed_fields = 6;

  // Error message if update failed
  string error_message = 7;

  // Error code for programmatic handling
  string error_code = 8;

  // Warning messages for partial updates
  repeated string warnings = 9;

  // Updated message properties summary
  UpdatedProperties updated_properties = 10;

  // Operation metadata
  map<string, string> metadata = 11;
}

// Information about fields that failed to update
message FailedFieldUpdate {
  // Field name that failed to update
  string field_name = 1;

  // Reason for failure
  string failure_reason = 2;

  // Error code specific to this field
  string error_code = 3;

  // Original value that couldn't be updated
  string original_value = 4;

  // Attempted new value
  string attempted_value = 5;
}

// Summary of updated message properties
message UpdatedProperties {
  // New priority level (if updated)
  int32 priority_level = 1;

  // New expiration time (if updated)
  google.protobuf.Timestamp expiration_time = 2;

  // New visibility timeout (if updated)
  int64 visibility_timeout_ms = 3;

  // New routing key (if updated)
  string routing_key = 4;

  // Updated metadata count
  int32 metadata_count = 5;

  // Updated headers count
  int32 headers_count = 6;

  // Content was updated
  bool content_updated = 7;

  // Size of updated content (bytes)
  int64 content_size_bytes = 8;
}
