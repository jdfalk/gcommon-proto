// file: pkg/auth/proto/types/session_metadata.proto
// file: auth/proto/types/session_metadata.proto
//
// Type definitions for auth module

//
edition = "2023";

package gcommon.v1.auth;

import "google/protobuf/go_features.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/pkg/auth/proto";

message SessionMetadata {
  // Session ID
  string session_id = 1;

  // User ID
  string user_id = 2;

  // Session start time
  int64 started_at = 3;

  // Last activity time
  int64 last_activity = 4;

  // Session expiry time
  int64 expires_at = 5;

  // IP address
  string ip_address = 6;

  // User agent
  string user_agent = 7;

  // Device information
  DeviceInfo device_info = 8;

  // Location information
  LocationInfo location_info = 9;

  // Session state
  enum SessionState {
    SESSION_STATE_UNSPECIFIED = 0;
    SESSION_STATE_ACTIVE = 1;
    SESSION_STATE_IDLE = 2;
    SESSION_STATE_EXPIRED = 3;
    SESSION_STATE_TERMINATED = 4;
  }
  SessionState state = 10;
}

message DeviceInfo {
  string device_id = 1;
  string device_type = 2; // mobile, desktop, tablet
  string os = 3;
  string browser = 4;
  bool is_trusted = 5;
}

message LocationInfo {
  string country = 1;
  string region = 2;
  string city = 3;
  double latitude = 4;
  double longitude = 5;
}

// Implement the actual protobuf definitions according to the auth module requirements
// This file needs proper implementation
