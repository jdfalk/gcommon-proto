// file: proto/gcommon/v1/common/messages/o_auth2_config.proto
// version: 1.1.0
// guid: a0b1c2d3-e4f5-6a7b-8c9d-0e1f2a3b4c5d

edition = "2023";

package gcommon.v1.common;

import "gcommon/v1/common/oauth2_flow_type.proto";
import "gcommon/v1/common/messages/jwt_config.proto";
import "google/protobuf/go_features.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/sdks/go/v1/common";

/**
 * OAuth2 configuration for authentication providers.
 * Supports various OAuth2 flows and provider configurations.
 */
message OAuth2Config {
  // OAuth2 provider name
  string provider_name = 1;

  // Client ID for OAuth2 application
  string client_id = 2;

  // Client secret for OAuth2 application
  string client_secret = 3;

  // Authorization endpoint URL
  string authorization_endpoint = 4;

  // Token endpoint URL
  string token_endpoint = 5;

  // User info endpoint URL
  string userinfo_endpoint = 6;

  // Redirect URI after authorization
  string redirect_uri = 7;

  // Requested scopes
  repeated string scopes = 8;

  // OAuth2 flow type
  gcommon.v1.common.OAuth2FlowType flow_type = 9;

  // Additional provider-specific parameters
  map<string, string> additional_params = 10;

  // Whether PKCE is required
  bool require_pkce = 11;

  // JWT configuration for token validation
  JWTConfig jwt_config = 12;
}
