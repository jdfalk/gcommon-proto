// file: proto/gcommon/v2/common/assign_role_request.proto
// version: 1.1.0
// guid: a1b2c3d4-e5f6-7a8b-9c0d-1e2f3a4b5c6d

edition = "2023";

package common.v2;

import "commonpb/v2/request_metadata.proto";
import "google/protobuf/go_features.proto";
import "buf/validate/validate.proto";

option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/pkg/commonpb/v2";

/**
 * Request to assign a role to a user.
 * Used for role-based access control management.
 * Grants the specified role permissions to the user.
 *
 * Example usage:
 * - Assigning admin role to a user
 * - Granting specific permissions through role assignment
 * - Managing user access control in the system
 */
message AssignRoleRequest {
  // User ID to assign role to (required)
  // Must be a valid user identifier in the system
  string user_id = 1 [
      (buf.validate.field).string.pattern = "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
      (buf.validate.field).required = true
    ];

  // Role ID to assign (required)
  // Must be a valid role identifier in the system
  string role_id = 2;

  // Optional organization context for scoped role assignment
  // If not provided, role is assigned globally
  string organization_id = 3 [
      (buf.validate.field).string.pattern = "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
      (buf.validate.field).required = true
    ];

  // Request metadata for tracing and correlation
  common.v2.RequestMetadata metadata = 4;

  // Audit information for tracking who made the assignment
  string assigned_by = 5;

  // Reason for role assignment (optional)
  string reason = 6;

  // Whether the assignment should be temporary
  bool temporary = 7;

  // Expiration time for temporary assignments
  int64 expires_at = 8;
}
