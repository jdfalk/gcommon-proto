// file: examples/auth_request.proto
// version: 1.0.0
// guid: 123e4567-e89b-12d3-a456-426614174003

edition = "2023";

package gcommon.v1.examples;

import "google/protobuf/go_features.proto";
import "buf/validate/validate.proto";


option features.(pb.go).api_level = API_OPAQUE;
option go_package = "github.com/jdfalk/gcommon/examples";

/**
 * Example authentication request demonstrating various validation patterns.
 */
message AuthRequest {
  // Client ID for authentication
  string client_id = 1 [(validate.rules).string.min_len = 1];

  // Username for login
  string username = 2 [(validate.rules).string.min_len = 1];

  // User password
  string password = 3 [(validate.rules).string.min_len = 8];

  // Contact email
  string contact_email = 4 [(validate.rules).string.pattern = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"];

  // Two-factor authentication code (6 digits)
  string tfa_code = 5 [(validate.rules).string.min_len = 1];

  // Request origin URL
  string origin_url = 6 [(validate.rules).string.uri = true];

  // Session duration in seconds
  int32 session_duration = 7 [(validate.rules).int32.gt = 0];

  // Maximum retry attempts
  int32 max_retries = 8 [(validate.rules).int32.gte = 0];

  // Backup email addresses
  repeated string backup_emails = 9 [(validate.rules).repeated.min_items = 1];
}